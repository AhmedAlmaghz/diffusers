# DiffEdit

[DiffEdit: Diffusion-based semantic image editing with mask guidance](https://huggingface.co/papers/2210.11427) هي ورقة بحثية كتبها غيوم كواريون، وجاكوب فيربيك، وهولجر شونك، وماثيو كورد.

ملخص الورقة البحثية هو:

*شهدت توليد الصور تقدمًا هائلاً في الآونة الأخيرة، مع السماح لنماذج الانتشار بتوليف صور مقنعة لمجموعة كبيرة من المطالبات النصية. وفي هذه المقالة، نقترح طريقة DiffEdit، وهي طريقة للاستفادة من نماذج الانتشار المشروطة بالنص لمهمة تحرير الصور الدلالية، حيث يتمثل الهدف في تحرير صورة بناءً على استعلام نصي. تحرير الصور الدلالية هو امتداد لتوليد الصور، مع القيد الإضافي بأن الصورة المولدة يجب أن تكون مشابهة قدر الإمكان لصورة المدخلات. تتطلب طرق التحرير الحالية القائمة على نماذج الانتشار عادةً توفير قناع، مما يجعل المهمة أسهل بكثير من خلال التعامل معها كمهام تعبئة مشروطة. على النقيض من ذلك، يمكن للمساهمة الرئيسية أن تولد تلقائيًا قناعًا يسلط الضوء على مناطق صورة الإدخال التي تحتاج إلى تحرير، من خلال مقارنة تنبؤات نموذج الانتشار المشروط بنصوص موجهة مختلفة. علاوة على ذلك، نعتمد على الاستدلال الخفي للحفاظ على المحتوى في مناطق الاهتمام ونظهر تآزرات ممتازة مع الانتشار القائم على القناع. يحقق DiffEdit أداء تحرير متميزًا على ImageNet. بالإضافة إلى ذلك، نقيم تحرير الصور الدلالية في إعدادات أكثر صعوبة، باستخدام الصور من مجموعة بيانات COCO بالإضافة إلى الصور المولدة القائمة على النص.*

يمكن العثور على الشفرة الأساسية الأصلية في [Xiang-cd/DiffEdit-stable-diffusion](https://github.com/Xiang-cd/DiffEdit-stable-diffusion)، ويمكنك تجربتها في هذا [العرض التوضيحي](https://blog.problemsolversguild.com/technical/research/2022/11/02/DiffEdit-Implementation.html).

تمت المساهمة بهذا الأنبوب بواسطة [clarencechen](https://github.com/clarencechen). ❤️

## نصائح

* يمكن لأنبوب التوصيل إنشاء أقنعة يمكن إدخالها في أنابيب التعبئة الأخرى.
* لتوليد صورة باستخدام هذا الأنبوب، يجب توفير كل من قناع صورة (يمكن تحديد مطالبات المصدر والهدف أو إنشاؤها يدويًا، وتمريرها إلى [`~StableDiffusionDiffEditPipeline.generate_mask`])
ومجموعة من العوامل الخفية المعكوسة جزئيًا (تم إنشاؤها باستخدام [`~StableDiffusionDiffEditPipeline.invert`]) _يجب_ توفيرها كوسيطة عند استدعاء الأنبوب لتوليد الصورة النهائية المحررة.
* تعرض الدالة [`~StableDiffusionDiffEditPipeline.generate_mask`] وسيطين للطلب، `source_prompt` و`target_prompt`
التي تتيح لك التحكم في مواقع التعديلات الدلالية في الصورة النهائية المراد إنشاؤها. لنفترض أنك
أردت الترجمة من "قطة" إلى "كلب". في هذه الحالة، سيكون اتجاه التحرير "قطة -> كلب". ليعكس
هذا في القناع المولد، ما عليك سوى تعيين التضمينات المتعلقة بالعبارات التي تشمل "قطة"
إلى `source_prompt` و"كلب" إلى `target_prompt`.
* عند إنشاء العوامل الخفية المعكوسة جزئيًا باستخدام `invert`، قم بتعيين تعليق أو تضمين نصي يصف
الصورة بالكامل إلى وسيطة `prompt` للمساعدة في توجيه عملية أخذ العينات العكسية الخفية. في معظم الحالات،
المصدر مفهوم وصفيا بما فيه الكفاية لتحقيق نتائج جيدة، ولكن لا تتردد في استكشاف البدائل.
* عند استدعاء الأنبوب لتوليد الصورة النهائية المحررة، قم بتعيين المفهوم المصدر إلى `negative_prompt`
والمفهوم المستهدف إلى `prompt`. باستخدام المثال أعلاه، ما عليك سوى تعيين التضمينات المتعلقة
العبارات التي تشمل "قطة" إلى `negative_prompt` و"كلب" إلى `prompt`.
* إذا كنت تريد عكس الاتجاه في المثال أعلاه، أي "كلب -> قطة"، فيوصى بما يلي:
* قم بالتبديل بين `source_prompt` و`target_prompt` في وسيطات `generate_mask`.
* تغيير المطالبة المدخلة في [`~StableDiffusionDiffEditPipeline.invert`] لتضمين "كلب".
* قم بالتبديل بين `prompt` و`negative_prompt` في وسيطات استدعاء الأنبوب لتوليد الصورة النهائية المحررة.
* يمكن أيضًا توليد المطالبات المصدر والهدف، أو تضميناتها المقابلة، تلقائيًا. يرجى الرجوع إلى دليل [DiffEdit](../../using-diffusers/diffedit) لمزيد من التفاصيل.

## StableDiffusionDiffEditPipeline

[[autodoc]] StableDiffusionDiffEditPipeline

- all
- generate_mask
- invert
- __call__

## StableDiffusionPipelineOutput

[[autodoc]] pipelines.stable_diffusion.StableDiffusionPipelineOutput